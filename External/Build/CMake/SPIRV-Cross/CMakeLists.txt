set(SPIRVCROSS_PROJECT_DIR "${EXTERNAL_PROJECT_DIR}/SPIRV-Cross")
SET(SPIRVCROSS_OUTPUT_DIR "${EXTERNAL_PROJECT_DIR}/lib/SPIRV-Cross/${KLAYGE_PLATFORM_NAME}")

UpdateExternalLib("SPIRV-Cross" "https://github.com/KhronosGroup/SPIRV-Cross.git" "c333445ada4f62eabd1d18d795259923cac0f94d")

FOREACH(flag_var
		CMAKE_CXX_FLAGS_RELEASE CMAKE_CXX_FLAGS_RELWITHDEBINFO CMAKE_CXX_FLAGS_MINSIZEREL)
	STRING(REPLACE "${NO_RTTI_FLAG}" "${RTTI_FLAG}" ${flag_var} "${${flag_var}}")
ENDFOREACH()

set(SPIRV_CROSS_ENABLE_GLSL ON CACHE BOOL "" FORCE)
set(SPIRV_CROSS_ENABLE_MSL ON CACHE BOOL "" FORCE)
set(SPIRV_CROSS_ENABLE_REFLECT ON CACHE BOOL "" FORCE)
set(SPIRV_CROSS_ENABLE_TESTS OFF CACHE BOOL "" FORCE)
set(SPIRV_CROSS_SHARED OFF CACHE BOOL "" FORCE)
set(SPIRV_CROSS_STATIC ON CACHE BOOL "" FORCE)
set(SPIRV_CROSS_CLI OFF CACHE BOOL "" FORCE)
set(SPIRV_CROSS_SKIP_INSTALL ON CACHE BOOL "" FORCE)

ADD_SUBDIRECTORY(${SPIRVCROSS_PROJECT_DIR} "${CMAKE_CURRENT_BINARY_DIR}/SPIRV-Cross")

#SET_TARGET_PROPERTIES(spirv-cross-c-shared PROPERTIES
#	ARCHIVE_OUTPUT_DIRECTORY ${SPIRVCROSS_OUTPUT_DIR}
#	ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${SPIRVCROSS_OUTPUT_DIR}
#	ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${SPIRVCROSS_OUTPUT_DIR}
#	ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${SPIRVCROSS_OUTPUT_DIR}
#	ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${SPIRVCROSS_OUTPUT_DIR}
#	RUNTIME_OUTPUT_DIRECTORY ${KLAYGE_BIN_DIR}
#	RUNTIME_OUTPUT_DIRECTORY_DEBUG ${KLAYGE_BIN_DIR}
#	RUNTIME_OUTPUT_DIRECTORY_RELEASE ${KLAYGE_BIN_DIR}
#	RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO ${KLAYGE_BIN_DIR}
#	RUNTIME_OUTPUT_DIRECTORY_MINSIZEREL ${KLAYGE_BIN_DIR}
#	LIBRARY_OUTPUT_DIRECTORY ${KLAYGE_BIN_DIR}
#	LIBRARY_OUTPUT_DIRECTORY_DEBUG ${KLAYGE_BIN_DIR}
#	LIBRARY_OUTPUT_DIRECTORY_RELEASE ${KLAYGE_BIN_DIR}
#	LIBRARY_OUTPUT_DIRECTORY_RELWITHDEBINFO ${KLAYGE_BIN_DIR}
#	LIBRARY_OUTPUT_DIRECTORY_MINSIZEREL ${KLAYGE_BIN_DIR}
#	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
#	OUTPUT_NAME spirv-cross${KLAYGE_OUTPUT_SUFFIX}
#	FOLDER "External/SPIRV-Cross"
#)

foreach(target
    "spirv-cross-core" "spirv-cross-cpp" "spirv-cross-reflect" "spirv-cross-glsl" "spirv-cross-hlsl" "spirv-cross-msl")
    set_target_properties(${target} PROPERTIES FOLDER "External/SPIRV-Cross")
endforeach()